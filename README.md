# Malware Analysis utils for cuckoo
A set of scripts to extract Ransomware from a local dataset of VirusTotal then decompress and submit them to cuckoo API. 

The local dataset is a folder with malwares and metadata (VirusTotal report) as json file and `.7z` file which contains the malware binary compressed with password `infected`. 
```
00970e2ea470620cb4e479c355a1bcaeac93e9ea09274162ee08ec79b5816907.7z
00970e2ea470620cb4e479c355a1bcaeac93e9ea09274162ee08ec79b5816907.json
011f94a5e5d0f20bc18ced3f44b99cbddec94de494c373a3021f20d03f790761.7z
011f94a5e5d0f20bc18ced3f44b99cbddec94de494c373a3021f20d03f790761.json
017525e76f2fe7cc4d9fdfbf04ac7130c9f90acfea294b824175e9a7d080707b.7z
...
```

## Find Ransomware 
`./find_ransom.sh > Ransomware_files_10.txt` script will extract all `malware.json` files that are detected by 10 or more anti-virus.


## Extract Ransomware .7z files
`./extractor.py` will extract all files that are in `Ransomware_files_10.txt` to their directory. 

## Submit to cuckoo
`./submit` will submit all extracted ransomware binary to cuckoo API and select the target VM to run the malware in. 



